<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>键盘监听</title>

    <!-- Core and extension CSS files -->
    <link rel="stylesheet" href="deck.js/core/deck.core.css">
    <link rel="stylesheet" href="deck.js/extensions/goto/deck.goto.css">
    <link rel="stylesheet" href="deck.js/extensions/menu/deck.menu.css">
    <link rel="stylesheet" href="deck.js/extensions/navigation/deck.navigation.css">
    <link rel="stylesheet" href="deck.js/extensions/status/deck.status.css">
    <link rel="stylesheet" href="deck.js/extensions/hash/deck.hash.css">
    
    <link rel="stylesheet" href="deck.js/introduction.css">
    
    <!-- Theme CSS files (menu swaps these out) -->
    <link rel="stylesheet" href="style/prettify.css">
    <link rel="stylesheet" id="style-theme-link" href="deck.js/themes/style/neon.css">
    <link rel="stylesheet" id="transition-theme-link" href="deck.js/themes/transition/horizontal-slide.css">
    <script src="style/jquery-1.7.min.js"></script>
    <script src="style/prettify.js"></script>
    <script src="deck.js/modernizr.custom.js"></script>
</head>

<body class="deck-container">

<div class="slide">
    <h1>键盘监听<br><br> <small style="position:absolute;right:20%;font-size:42px;">计3牛轶超</small></h1>
</div>


<div class="slide" style="line-height:60px;">
    <h2>键盘原理</h2>
    <h3>键盘一般由按键、导电塑胶、编码器以及接口电路等组成。<br>
     当有按键事件发生 ，键盘中的编码器能够迅速将此按键所对应的编码通过<br>
     接口电路输送到计算机的键盘缓冲器中，由CPU进行识别处理。<br>
     键盘的每个按键都有对应的编码(类似ASCII码)，编码器会根据相应按键编<br>
     码。
     </h3>
</div>

<div class="slide">
    <h2>键码表(keycode)</h2>
    <img src="keycode.png" data-pinit="registered">
    <h3>P173</h3>
</div>

<div class="slide">
    <h2>Javascript 键盘监听</h2>
    <pre class="prettyprint">
        <code>
function keypress(){
    var bd = document.getElementsByTagName('body')[0];
    var bindcode = document.getElementById('bindcode');
    bd.onkeypress = function(ev){
        var code = ev.keyCode || ev.which;
        var keyChar = String.fromCharCode(code);
        bindcode.innerHTML = ('keycode ' + code + '\t:\t' + 'key ' + keyChar);
    }
}           
        </code>
    </pre>
    <h3 id='bindcode'></h3>
    <script type="text/javascript">

        function keypress(){
            var body = document.getElementsByTagName('body')[0];
            var bindcode = document.getElementById('bindcode');
            bindcode.innerHTML = ('keycode ' + '\t:\t' + 'key');
            body.onkeypress = function(ev){
                var code = ev.keyCode || ev.which;
                var keyChar = String.fromCharCode(code);
                bindcode.innerHTML = ('keycode ' + code + '\t:\t' + 'key ' + keyChar);
            }
        } 
        window.onload = keypress;
    </script>
</div>

<div class="slide">
    <h2>kbhit()函数</h2>
    <h3>检查当前是否有键盘输入，若有则返回一个非0值，否则返回0</h3>
    <br>
    <pre><code>
#include &lt;stdio.h&gt;
#include &lt;conio.h&gt;
 
int main(void) 
{ 
   cprintf("Press any key to continue:"); 
   while (!_kbhit());
   cprintf("\r\n A key was pressed.\r\n"); 
   return 0; 
} 
    </code></pre>
</div>

<div class="slide">
  <h2>Linux C语言键盘监听</h2>
  <pre>
   <code>
#include &lt;stdio.h&gt; 
#include &lt;unistd.h&gt; 
#include &lt;termios.h&gt; 
  
static struct termios initial_settings, new_settings; 
static int peek_character = -1; 

void init()
{ 
     tcgetattr(0, &initial_settings); 
     //获取命令行参数, 0 当前终端 
     
     new_settings = initial_settings; 
     new_settings.c_lflag &= ~(ICANON|ISIG|TOSTOP); 
     /* c_lflag 本地模式标志，控制终端编辑功能
     SIG 当输入INTR、QUIT、SUSP或DSUSP时，产生相应的信号
     ICANON 使用标准输入模式
     TOSTOP 向后台输出发送SIGTTOU信号
    */

     new_settings.c_cc[VMIN] = 1; 
     // 非 canonical 模式读的最小字符数

     new_settings.c_cc[VTIME] = 0; 
     //非 canonical 模式读时的延时，以十分之一秒为单位 

     tcsetattr(0, TCSANOW, &new_settings);
     /* 
     int tcsetattr(int fd,int actions,const struct termios *termios_p);
     TCSANOW：改变立即发生 
     */
} 
  
void close_bind(){ 
     tcsetattr(0, TCSANOW, &initial_settings); 
} 
  
int bind()//监听键盘 
{ 
     unsigned char ch; 
     int nread; 
  
     if (peek_character != -1) 
         return 1; 
     new_settings.c_cc[VMIN]=0; 
     tcsetattr(0, TCSANOW, &new_settings); 
     nread = read(0, &ch, 1); 
     new_settings.c_cc[VMIN]=1; 
     tcsetattr(0, TCSANOW, &new_settings); 
     if(nread == 1) 
     { 
         peek_character = ch; 
         return 1; 
     } 
     return 0; 
} 
  
int get()//读取字符 
{ 
     char ch; 
  
     if(peek_character != -1) 
     { 
         ch = peek_character; 
         peek_character = -1; 
         return ch; 
     } 
     read(0, &ch, 1); 
     return ch; 
} 
  
int main() 
{ 
     init(); 
     FILE *fp; 
     fp = fopen("KeyBind", "w"); 
     while(1)  
     { 
         while(!bind()) 
             ; 
         char ch = get(); 
         if(ch == '-') 
            break; 
         fprintf(fp, "%c", ch); 
     } 
     fclose(fp); 
     close_bind(); 
     printf("\nBind end!\n"); 
} 

   </code>
   </pre>
</div>

<div class="slide">
    <h1>谢谢</h1>
</div>
<!-- 
<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>
-->
 
<p class="deck-status">
    <span class="deck-status-current"></span>
    /
    <span class="deck-status-total"></span>
</p>


<a href="." title="Permalink to this slide" class="deck-permalink">#</a>

<script src="style/jquery-1.7.min.js"></script>

<!-- Deck Core and extensions -->
<script src="deck.js/core/deck.core.js"></script>
<script src="deck.js/extensions/menu/deck.menu.js"></script>
<script src="deck.js/extensions/goto/deck.goto.js"></script>
<script src="deck.js/extensions/status/deck.status.js"></script>
<script src="deck.js/extensions/navigation/deck.navigation.js"></script>
<script src="deck.js/extensions/hash/deck.hash.js"></script>

<!-- Specific to this page -->
<script src="deck.js/introduction/introduction.js"></script>
<script>
$(function() {
  // Deck initialization
  $.deck('.slide');
  $('pre code').parent().addClass('prettyprint');
  prettyPrint();
});
</script>

</body>
</html>
